# åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ (Distributed Task Scheduler)

åŸºäº Rust æ„å»ºçš„é«˜æ€§èƒ½ã€å¯æ‰©å±•çš„åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿï¼Œé‡‡ç”¨ç°ä»£åŒ–å¾®æœåŠ¡æ¶æ„ï¼Œæ”¯æŒä¼ä¸šçº§å¤§è§„æ¨¡ä»»åŠ¡è°ƒåº¦å’Œå·¥ä½œèŠ‚ç‚¹ç®¡ç†ã€‚

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

### ğŸš€ é«˜æ€§èƒ½æ¶æ„
- **å¼‚æ­¥é©±åŠ¨**: åŸºäº Tokio è¿è¡Œæ—¶ï¼Œæ”¯æŒä¸‡çº§å¹¶å‘
- **è¿æ¥æ± ä¼˜åŒ–**: æ•°æ®åº“å’Œæ¶ˆæ¯é˜Ÿåˆ—æ™ºèƒ½è¿æ¥ç®¡ç†  
- **æ‰¹é‡å¤„ç†**: é«˜ååé‡ä»»åŠ¡å¤„ç†å’ŒçŠ¶æ€æ›´æ–°
- **å†…å­˜é«˜æ•ˆ**: é›¶æ‹·è´è®¾è®¡å’Œæ™ºèƒ½ç¼“å­˜ç­–ç•¥

### ğŸ—ï¸ ä¼ä¸šçº§æ‰©å±•æ€§
- **å¾®æœåŠ¡æ¶æ„**: æ¸…æ´æ¶æ„è®¾è®¡ï¼Œç»„ä»¶è§£è€¦å’Œæ°´å¹³æ‰©å±•
- **å¤šæ¶ˆæ¯é˜Ÿåˆ—**: RabbitMQ/Redis Stream æ”¯æŒï¼Œè¿è¡Œæ—¶åˆ‡æ¢
- **å¤šæ•°æ®åº“**: PostgreSQL/SQLite æ”¯æŒï¼Œè¯»å†™åˆ†ç¦»
- **äº‘åŸç”Ÿ**: Kubernetes å°±ç»ªï¼Œå®¹å™¨åŒ–éƒ¨ç½²

### ğŸ›¡ï¸ ç”Ÿäº§çº§å¯é æ€§
- **å®¹é”™è®¾è®¡**: ç†”æ–­å™¨ã€æŒ‡æ•°é€€é¿é‡è¯•ã€æ•…éšœè‡ªæ„ˆ
- **å®‰å…¨è®¤è¯**: JWT/API Key åŒé‡è®¤è¯ï¼ŒRBAC æƒé™æ§åˆ¶
- **å®¡è®¡è¿½è¸ª**: åˆ†å¸ƒå¼è¿½è¸ªã€ç»“æ„åŒ–æ—¥å¿—ã€æ“ä½œå®¡è®¡
- **é…ç½®ç®¡ç†**: å¤šç¯å¢ƒé…ç½®ã€çƒ­æ›´æ–°ã€å®‰å…¨åŠ å¯†

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿ                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   REST API      â”‚  â”‚   Scheduler     â”‚  â”‚   Web UI        â”‚     â”‚
â”‚  â”‚   (HTTPæ¥å£)     â”‚  â”‚   (ä»»åŠ¡è°ƒåº¦)     â”‚  â”‚   (ç®¡ç†ç•Œé¢)     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚           â”‚                     â”‚                     â”‚           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Message Queue                                 â”‚   â”‚
â”‚  â”‚              (æ¶ˆæ¯é˜Ÿåˆ—é€šä¿¡å±‚)                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”‚                     â”‚                     â”‚           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   Worker Pool   â”‚  â”‚   Database      â”‚  â”‚   Monitoring    â”‚     â”‚
â”‚  â”‚   (Workeré›†ç¾¤)   â”‚  â”‚   (æ•°æ®å­˜å‚¨)     â”‚  â”‚   (ç›‘æ§å‘Šè­¦)     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
scheduler/
â”œâ”€â”€ Cargo.toml                          # Workspaceé…ç½®
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.rs                         # åº”ç”¨å…¥å£ç‚¹
â”‚   â””â”€â”€ app.rs                          # åº”ç”¨é…ç½®
â”œâ”€â”€ crates/
â”‚   â”œâ”€â”€ core/                           # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ models/                 # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs              # æ¨¡å‹å¯¼å‡º
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ task.rs             # ä»»åŠ¡æ¨¡å‹
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ task_run.rs         # ä»»åŠ¡è¿è¡Œæ¨¡å‹
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ worker.rs           # Workeræ¨¡å‹
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ message.rs          # æ¶ˆæ¯æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ traits/                 # æœåŠ¡æ¥å£
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs              # Traitå¯¼å‡º
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ repository.rs       # æ•°æ®ä»“åº“æ¥å£
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ scheduler.rs        # è°ƒåº¦å™¨æ¥å£
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ task_executor.rs    # ä»»åŠ¡æ‰§è¡Œå™¨æ¥å£
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ message_queue.rs    # æ¶ˆæ¯é˜Ÿåˆ—æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ services/               # æœåŠ¡å®ç°
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs              # æœåŠ¡å¯¼å‡º
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ task_services.rs    # ä»»åŠ¡æœåŠ¡
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ worker_services.rs  # WorkeræœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ config/                 # é…ç½®ç®¡ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs              # é…ç½®å¯¼å‡º
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ models/             # é…ç½®æ¨¡å‹
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ validation.rs       # é…ç½®éªŒè¯
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ environment.rs      # ç¯å¢ƒé…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ logging/                # æ—¥å¿—ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs              # æ—¥å¿—å¯¼å‡º
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ structured_logger.rs # ç»“æ„åŒ–æ—¥å¿—
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ log_config.rs       # æ—¥å¿—é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ errors.rs               # é”™è¯¯å®šä¹‰
â”‚   â”‚   â”‚   â”œâ”€â”€ circuit_breaker.rs      # ç†”æ–­å™¨
â”‚   â”‚   â”‚   â””â”€â”€ lib.rs                  # æ ¸å¿ƒæ¨¡å—å…¥å£
â”‚   â”‚   â”œâ”€â”€ tests/                      # æµ‹è¯•
â”‚   â”‚   â””â”€â”€ examples/                   # ç¤ºä¾‹ä»£ç 
â”‚   â”œâ”€â”€ api/                            # REST APIæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ handlers/               # è¯·æ±‚å¤„ç†å™¨
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ tasks.rs            # ä»»åŠ¡å¤„ç†å™¨
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ workers.rs          # Workerå¤„ç†å™¨
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ system.rs           # ç³»ç»Ÿå¤„ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ middleware/             # ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ cors.rs             # CORSä¸­é—´ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ auth.rs             # è®¤è¯ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ logging.rs          # æ—¥å¿—ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ routes.rs               # è·¯ç”±å®šä¹‰
â”‚   â”‚   â”‚   â”œâ”€â”€ error.rs                # é”™è¯¯å¤„ç†
â”‚   â”‚   â”‚   â””â”€â”€ lib.rs                  # APIæ¨¡å—å…¥å£
â”‚   â”‚   â””â”€â”€ tests/                      # APIæµ‹è¯•
â”‚   â”œâ”€â”€ dispatcher/                     # ä»»åŠ¡è°ƒåº¦å™¨
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ scheduler.rs            # è°ƒåº¦å™¨æ ¸å¿ƒ
â”‚   â”‚   â”‚   â”œâ”€â”€ strategies.rs           # è°ƒåº¦ç­–ç•¥
â”‚   â”‚   â”‚   â”œâ”€â”€ cron_utils.rs           # Cronè¡¨è¾¾å¼å·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ dependency_checker.rs  # ä¾èµ–æ£€æŸ¥å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ recovery_service.rs     # æ•…éšœæ¢å¤æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ retry_service.rs       # é‡è¯•æœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ lib.rs                  # è°ƒåº¦å™¨æ¨¡å—å…¥å£
â”‚   â”‚   â””â”€â”€ tests/                      # è°ƒåº¦å™¨æµ‹è¯•
â”‚   â”œâ”€â”€ worker/                         # WorkeræœåŠ¡
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ service.rs              # WorkeræœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ executors.rs            # ä»»åŠ¡æ‰§è¡Œå™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ heartbeat.rs            # å¿ƒè·³ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ components/             # ç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ task_execution.rs   # ä»»åŠ¡æ‰§è¡Œç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ worker_lifecycle.rs # Workerç”Ÿå‘½å‘¨æœŸ
â”‚   â”‚   â”‚   â””â”€â”€ lib.rs                  # Workeræ¨¡å—å…¥å£
â”‚   â”‚   â””â”€â”€ tests/                      # Workeræµ‹è¯•
â”‚   â”œâ”€â”€ infrastructure/                 # åŸºç¡€è®¾æ–½
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ database/               # æ•°æ®åº“
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ mod.rs              # æ•°æ®åº“å¯¼å‡º
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ manager.rs          # æ•°æ®åº“ç®¡ç†å™¨
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ postgres/           # PostgreSQLå®ç°
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ sqlite/             # SQLiteå®ç°
â”‚   â”‚   â”‚   â”œâ”€â”€ message_queue.rs        # æ¶ˆæ¯é˜Ÿåˆ—æŠ½è±¡
â”‚   â”‚   â”‚   â”œâ”€â”€ message_queue_factory.rs # æ¶ˆæ¯é˜Ÿåˆ—å·¥å‚
â”‚   â”‚   â”‚   â”œâ”€â”€ redis_stream/          # Redis Streamå®ç°
â”‚   â”‚   â”‚   â””â”€â”€ observability/         # å¯è§‚æµ‹æ€§
â”‚   â”‚   â”‚       â”œâ”€â”€ mod.rs              # å¯è§‚æµ‹æ€§å¯¼å‡º
â”‚   â”‚   â”‚       â”œâ”€â”€ metrics_collector.rs # æŒ‡æ ‡æ”¶é›†å™¨
â”‚   â”‚   â”‚       â””â”€â”€ structured_logger.rs # ç»“æ„åŒ–æ—¥å¿—
â”‚   â”‚   â””â”€â”€ tests/                      # åŸºç¡€è®¾æ–½æµ‹è¯•
â”‚   â””â”€â”€ domain/                         # é¢†åŸŸæ¨¡å‹
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ entities.rs             # å®ä½“å®šä¹‰
â”‚       â”‚   â”œâ”€â”€ value_objects.rs        # å€¼å¯¹è±¡
â”‚       â”‚   â”œâ”€â”€ events.rs               # é¢†åŸŸäº‹ä»¶
â”‚       â”‚   â”œâ”€â”€ repositories.rs         # ä»“åº“æ¥å£
â”‚       â”‚   â””â”€â”€ services.rs             # é¢†åŸŸæœåŠ¡
â”‚       â””â”€â”€ tests/                      # é¢†åŸŸæµ‹è¯•
â”œâ”€â”€ config/                              # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ development.toml                # å¼€å‘ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ production.toml                 # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”‚   â”œâ”€â”€ rabbitmq.toml                   # RabbitMQé…ç½®
â”‚   â”œâ”€â”€ redis-stream.toml               # Redis Streamé…ç½®
â”‚   â””â”€â”€ scheduler.toml                 # è°ƒåº¦å™¨é…ç½®
â”œâ”€â”€ migrations/                          # æ•°æ®åº“è¿ç§»
â”œâ”€â”€ docs/                               # æ–‡æ¡£
â”‚   â”œâ”€â”€ CODING_STANDARDS.md             # ç¼–ç è§„èŒƒ
â”‚   â”œâ”€â”€ CODE_REVIEW_CHECKLIST.md        # ä»£ç è¯„å®¡æ£€æŸ¥æ¸…å•
â”‚   â””â”€â”€ API_DOCUMENTATION.md            # APIæ–‡æ¡£
â”œâ”€â”€ monitoring/                         # ç›‘æ§é…ç½®
â”‚   â””â”€â”€ prometheus.yml                  # Prometheusé…ç½®
â”œâ”€â”€ docker-compose.yml                  # Dockerç¼–æ’
â”œâ”€â”€ docker-compose.dev.yml              # å¼€å‘ç¯å¢ƒç¼–æ’
â””â”€â”€ Dockerfile                          # Dockeré•œåƒ
```

## ğŸ”§ æ ¸å¿ƒç»„ä»¶

### ğŸ“‹ Core æ¨¡å—

ç³»ç»Ÿçš„æ ¸å¿ƒæ¨¡å—ï¼Œå®šä¹‰äº†åŸºç¡€æ•°æ®ç»“æ„ã€æœåŠ¡æ¥å£å’Œé”™è¯¯å¤„ç†æœºåˆ¶ã€‚

- **æ•°æ®æ¨¡å‹**: Taskã€TaskRunã€WorkerInfoã€Message
- **æœåŠ¡æ¥å£**: TaskControlServiceã€WorkerServiceã€MessageQueue
- **é…ç½®ç®¡ç†**: å¤šç¯å¢ƒé…ç½®ã€é…ç½®éªŒè¯ã€çƒ­æ›´æ–°
- **é”™è¯¯å¤„ç†**: ç»Ÿä¸€é”™è¯¯ç±»å‹ã€é”™è¯¯ä¼ æ’­ã€æ¢å¤æœºåˆ¶
- **æ—¥å¿—ç³»ç»Ÿ**: ç»“æ„åŒ–æ—¥å¿—ã€æ€§èƒ½è¿½è¸ªã€å®¡è®¡æ—¥å¿—

### ğŸŒ API æ¨¡å—

åŸºäºAxumæ¡†æ¶çš„REST APIæœåŠ¡ï¼Œæä¾›HTTPæ¥å£ç”¨äºç³»ç»Ÿç®¡ç†ã€‚

- **ä»»åŠ¡ç®¡ç†**: åˆ›å»ºã€æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤ä»»åŠ¡
- **Workerç®¡ç†**: æ³¨å†Œã€å¿ƒè·³ã€çŠ¶æ€æŸ¥è¯¢
- **ç³»ç»Ÿç›‘æ§**: å¥åº·æ£€æŸ¥ã€æ€§èƒ½æŒ‡æ ‡ã€æ—¥å¿—æŸ¥è¯¢
- **ä¸­é—´ä»¶**: CORSã€è®¤è¯ã€æ—¥å¿—ã€é™æµ

### âš¡ Dispatcher æ¨¡å—

ä»»åŠ¡è°ƒåº¦å™¨æ ¸å¿ƒï¼Œè´Ÿè´£ä»»åŠ¡è°ƒåº¦å’Œä¾èµ–ç®¡ç†ã€‚

- **è°ƒåº¦ç­–ç•¥**: æ”¯æŒå¤šç§è°ƒåº¦ç®—æ³•
- **ä¾èµ–ç®¡ç†**: ä»»åŠ¡ä¾èµ–å…³ç³»æ£€æŸ¥
- **å®šæ—¶ä»»åŠ¡**: Cronè¡¨è¾¾å¼æ”¯æŒ
- **æ•…éšœæ¢å¤**: è‡ªåŠ¨é‡è¯•å’Œæ•…éšœè½¬ç§»

### ğŸ”§ Worker æ¨¡å—

WorkerèŠ‚ç‚¹æœåŠ¡ï¼Œè´Ÿè´£ä»»åŠ¡æ‰§è¡Œå’ŒçŠ¶æ€ä¸ŠæŠ¥ã€‚

- **ä»»åŠ¡æ‰§è¡Œ**: æ”¯æŒå¤šç§æ‰§è¡Œå™¨ç±»å‹
- **å¿ƒè·³ç®¡ç†**: å®šæœŸå¿ƒè·³å’Œå¥åº·æ£€æŸ¥
- **è´Ÿè½½å‡è¡¡**: ä»»åŠ¡åˆ†é…å’Œè´Ÿè½½æ§åˆ¶
- **ç”Ÿå‘½å‘¨æœŸ**: å¯åŠ¨ã€è¿è¡Œã€åœæ­¢ç®¡ç†

### ğŸ—ï¸ Infrastructure æ¨¡å—

åŸºç¡€è®¾æ–½æŠ½è±¡å±‚ï¼Œæä¾›æ•°æ®åº“å’Œæ¶ˆæ¯é˜Ÿåˆ—çš„ç»Ÿä¸€æ¥å£ã€‚

- **æ•°æ®åº“**: PostgreSQLã€SQLiteæ”¯æŒ
- **æ¶ˆæ¯é˜Ÿåˆ—**: RabbitMQã€Redis Streamæ”¯æŒ
- **å¯è§‚æµ‹æ€§**: æŒ‡æ ‡æ”¶é›†ã€åˆ†å¸ƒå¼è¿½è¸ª
- **è¿æ¥æ± **: é«˜æ€§èƒ½è¿æ¥ç®¡ç†

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Rust**: 1.70+
- **PostgreSQL**: 13+
- **RabbitMQ**: 3.8+
- **Redis**: 6.0+ (å¯é€‰)

### å®‰è£…å’Œè¿è¡Œ

1. **å…‹éš†é¡¹ç›®**

```bash
git clone https://github.com/your-org/scheduler.git
cd scheduler
```

2. **å¯åŠ¨ä¾èµ–æœåŠ¡**

```bash
docker-compose up -d
```

3. **è¿è¡Œæ•°æ®åº“è¿ç§»**

```bash
cargo run --bin migrate
```

4. **å¯åŠ¨è°ƒåº¦å™¨**

```bash
cargo run --bin scheduler
```

5. **å¯åŠ¨Worker**

```bash
cargo run --bin worker
```

6. **å¯åŠ¨APIæœåŠ¡**

```bash
cargo run --bin api
```

### é…ç½®æ–‡ä»¶

**å¼€å‘ç¯å¢ƒé…ç½®** (`config/development.toml`)

```toml
[database]
url = "postgresql://localhost:5432/scheduler_dev"
pool_size = 10

[message_queue]
type = "rabbitmq"
host = "localhost"
port = 5672
username = "guest"
password = "guest"

[api]
host = "127.0.0.1"
port = 8080

[dispatcher]
max_workers = 50
task_timeout_seconds = 3600

[worker]
heartbeat_interval_seconds = 30
max_concurrent_tasks = 5
```

### API ä½¿ç”¨ç¤ºä¾‹

**åˆ›å»ºä»»åŠ¡**

```bash
curl -X POST http://localhost:8080/api/tasks \
  -H "Content-Type: application/json" \
  -d '{
    "name": "data_processing",
    "description": "å¤„ç†æ¯æ—¥æ•°æ®",
    "task_type": "batch",
    "executor": "python",
    "command": "process_data.py",
    "schedule": "0 2 * * *",
    "priority": "normal",
    "retry_count": 3,
    "timeout_seconds": 3600
  }'
```

**æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€**

```bash
curl -X GET http://localhost:8080/api/tasks/1
```

**æ‰‹åŠ¨è§¦å‘ä»»åŠ¡**

```bash
curl -X POST http://localhost:8080/api/tasks/1/trigger
```

## ğŸ§ª å¼€å‘å’Œæµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
cargo test

# è¿è¡Œç‰¹å®šæ¨¡å—æµ‹è¯•
cargo test -p scheduler-core

# è¿è¡Œé›†æˆæµ‹è¯•
cargo test --test integration_tests

# è¿è¡ŒAPIæµ‹è¯•
cargo test -p scheduler-api
```

### ä»£ç è´¨é‡æ£€æŸ¥

```bash
# æ ¼å¼åŒ–ä»£ç 
cargo fmt

# æ£€æŸ¥ä»£ç æ ¼å¼
cargo fmt --check

# é™æ€åˆ†æ
cargo clippy

# è¿è¡Œæ‰€æœ‰æ£€æŸ¥
cargo check --all-targets
```

### å¼€å‘å·¥å…·

```bash
# ç”Ÿæˆæ–‡æ¡£
cargo doc --no-deps

# æ‰“å¼€æ–‡æ¡£
cargo doc --open

# åˆ†æä¾èµ–
cargo tree
cargo outdated

# æ€§èƒ½åˆ†æ
cargo flamegraph
```

## ğŸ“Š ç›‘æ§å’Œè¿ç»´

### ç³»ç»Ÿç›‘æ§

ç³»ç»Ÿå†…ç½®äº†å®Œæ•´çš„ç›‘æ§åŠŸèƒ½ï¼š

- **å¥åº·æ£€æŸ¥**: `/health` ç«¯ç‚¹
- **æ€§èƒ½æŒ‡æ ‡**: `/metrics` ç«¯ç‚¹ (Prometheusæ ¼å¼)
- **ç³»ç»ŸçŠ¶æ€**: `/api/system/stats` ç«¯ç‚¹
- **æ—¥å¿—æŸ¥è¯¢**: `/api/system/logs` ç«¯ç‚¹

### é…ç½®Prometheusç›‘æ§

```yaml
# monitoring/prometheus.yml
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'scheduler'
    static_configs:
      - targets: ['localhost:8080']
    metrics_path: '/metrics'
```

### å‘Šè­¦è§„åˆ™

```yaml
# monitoring/alerts.yml
groups:
  - name: scheduler
    rules:
      - alert: HighTaskFailureRate
        expr: rate(task_failures_total[5m]) > 0.1
        for: 10m
        labels:
          severity: warning
        annotations:
          summary: "ä»»åŠ¡å¤±è´¥ç‡è¿‡é«˜"
```

## ğŸ”’ å®‰å…¨è€ƒè™‘

### è®¤è¯å’Œæˆæƒ

- **APIå¯†é’¥**: æ”¯æŒAPIå¯†é’¥è®¤è¯
- **JWTä»¤ç‰Œ**: æ”¯æŒJWTä»¤ç‰Œè®¤è¯
- **æƒé™æ§åˆ¶**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
- **IPç™½åå•**: æ”¯æŒIPè®¿é—®é™åˆ¶

### æ•°æ®å®‰å…¨

- **æ•æ„Ÿä¿¡æ¯**: é…ç½®æ–‡ä»¶ä¸­çš„æ•æ„Ÿä¿¡æ¯æ”¯æŒåŠ å¯†
- **æ•°æ®åº“è¿æ¥**: æ”¯æŒSSL/TLSåŠ å¯†è¿æ¥
- **æ¶ˆæ¯é˜Ÿåˆ—**: æ”¯æŒåŠ å¯†é€šä¿¡
- **å®¡è®¡æ—¥å¿—**: å®Œæ•´çš„æ“ä½œå®¡è®¡è®°å½•

### ç½‘ç»œå®‰å…¨

- **CORS**: è·¨åŸŸèµ„æºå…±äº«æ§åˆ¶
- **é€Ÿç‡é™åˆ¶**: APIè®¿é—®é¢‘ç‡é™åˆ¶
- **è¾“å…¥éªŒè¯**: ä¸¥æ ¼çš„è¾“å…¥å‚æ•°éªŒè¯
- **SQLæ³¨å…¥é˜²æŠ¤**: ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢

## ğŸš€ éƒ¨ç½²æŒ‡å—

### Dockeréƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t scheduler:latest .

# ä½¿ç”¨docker-composeå¯åŠ¨
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps
docker-compose logs
```

### Kuberneteséƒ¨ç½²

```yaml
# k8s/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: scheduler
spec:
  replicas: 3
  selector:
    matchLabels:
      app: scheduler
  template:
    metadata:
      labels:
        app: scheduler
    spec:
      containers:
      - name: scheduler
        image: scheduler:latest
        ports:
        - containerPort: 8080
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: scheduler-secret
              key: database-url
```

### ç”Ÿäº§ç¯å¢ƒé…ç½®

```toml
# config/production.toml
[database]
url = "postgresql://prod-db:5432/scheduler"
pool_size = 50
connection_timeout_seconds = 60

[message_queue]
type = "rabbitmq"
host = "rabbitmq-cluster"
port = 5672
username = "scheduler"
password = "${RABBITMQ_PASSWORD}"

[api]
host = "0.0.0.0"
port = 8080
cors_origins = ["https://app.example.com"]

[observability]
log_level = "info"
metrics_enabled = true
tracing_enabled = true
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘æµç¨‹

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯: `git checkout -b feature/new-feature`
3. æäº¤æ›´æ”¹: `git commit -m 'Add new feature'`
4. æ¨é€åˆ†æ”¯: `git push origin feature/new-feature`
5. åˆ›å»ºPull Request

### ä»£ç è§„èŒƒ

- éµå¾ª [CODING_STANDARDS.md](docs/CODING_STANDARDS.md)
- é€šè¿‡ [CODE_REVIEW_CHECKLIST.md](docs/CODE_REVIEW_CHECKLIST.md) æ£€æŸ¥
- ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡
- æ›´æ–°ç›¸å…³æ–‡æ¡£

### æäº¤è§„èŒƒ

```
feat: æ–°åŠŸèƒ½
fix: Bugä¿®å¤
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼åŒ–
refactor: ä»£ç é‡æ„
test: æµ‹è¯•ç›¸å…³
chore: æ„å»ºæˆ–å·¥å…·ç›¸å…³
```

## ğŸ“ˆ æ€§èƒ½åŸºå‡†

### ç³»ç»Ÿå®¹é‡

- **ä»»åŠ¡è°ƒåº¦**: 10,000+ tasks/minute
- **WorkerèŠ‚ç‚¹**: 100+ nodes
- **å¹¶å‘æ‰§è¡Œ**: 1,000+ concurrent tasks
- **æ¶ˆæ¯å¤„ç†**: 50,000+ messages/second

### å“åº”æ—¶é—´

- **APIå“åº”**: < 100ms (P99)
- **ä»»åŠ¡è°ƒåº¦**: < 1s
- **ä»»åŠ¡æ‰§è¡Œ**: å–å†³äºä»»åŠ¡ç±»å‹
- **æ•…éšœæ¢å¤**: < 30s

### èµ„æºä½¿ç”¨

- **å†…å­˜**: 512MB (base) + 10MB per 1000 tasks
- **CPU**: 2 cores (base) + scaling based on load
- **å­˜å‚¨**: 1GB (base) + 100KB per task
- **ç½‘ç»œ**: 1Gbps recommended

## ğŸ†˜ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ•°æ®åº“è¿æ¥å¤±è´¥**: æ£€æŸ¥æ•°æ®åº“é…ç½®å’Œç½‘ç»œè¿æ¥
2. **æ¶ˆæ¯é˜Ÿåˆ—è¿æ¥å¤±è´¥**: æ£€æŸ¥æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡çŠ¶æ€
3. **ä»»åŠ¡æ‰§è¡Œå¤±è´¥**: æ£€æŸ¥Workeræ—¥å¿—å’Œä»»åŠ¡é…ç½®
4. **æ€§èƒ½é—®é¢˜**: æ£€æŸ¥ç³»ç»Ÿèµ„æºå’Œé…ç½®å‚æ•°

### æ—¥å¿—åˆ†æ

```bash
# æŸ¥çœ‹è°ƒåº¦å™¨æ—¥å¿—
docker-compose logs scheduler

# æŸ¥çœ‹Workeræ—¥å¿—
docker-compose logs worker

# æŸ¥çœ‹APIæ—¥å¿—
docker-compose logs api

# æŸ¥çœ‹ç‰¹å®šé”™è¯¯
docker-compose logs | grep ERROR
```

### æ€§èƒ½è°ƒä¼˜

```bash
# åˆ†æCPUä½¿ç”¨
top -p $(pgrep scheduler)

# åˆ†æå†…å­˜ä½¿ç”¨
cat /proc/$(pgrep scheduler)/status

# åˆ†æç½‘ç»œè¿æ¥
netstat -an | grep 8080
```

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºè¿™ä¸ªé¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…å’Œç¤¾åŒºæˆå‘˜ã€‚

## ğŸ“ æ”¯æŒ

- **æ–‡æ¡£**: [é¡¹ç›®æ–‡æ¡£](docs/)
- **é—®é¢˜æŠ¥å‘Š**: [GitHub Issues](https://github.com/your-org/scheduler/issues)
- **è®¨è®º**: [GitHub Discussions](https://github.com/your-org/scheduler/discussions)
- **é‚®ä»¶**: <support@example.com>

---

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ªStarï¼**
